mean = mean(DF$Gasto_semanal_cafe, na.rm = TRUE),
sd = sd(DF$Gasto_semanal_cafe, na.rm = TRUE)),
lwd = 2, col = "darkgreen")
legend("topright", legend = c("Empírica", "Normal"),
col = c("red", "darkgreen"), lwd = 2)
# Calcular la tasa lambda para la distribución exponencial
lambda <- 1 / mean(DF$Gasto_semanal_cafe)
# Crear el histograma con la densidad empírica
hist(DF$Gasto_semanal_cafe,
breaks = 45,
probability = TRUE,
main = "Gráfico del Gasto semanal en café",
col = "lightblue")
# Línea de densidad empírica
lines(density(DF$Gasto_semanal_cafe, na.rm = TRUE), lwd = 3, col = "red")
# Superponer la curva de densidad teórica (distribución exponencial)
curve(dexp(x, rate = lambda), col = "blue", lwd = 2, add = TRUE)
# Añadir leyenda
legend("topright", legend = c("Empírica", "Exponencial Ajustada"),
col = c("red", "blue"), lwd = 2)
lambda <- 1 / mean(DF$Gasto_semanal_cafe)
# Calcular la esperanza (media)
esperanza <- 1 / lambda
# Calcular la varianza
varianza <- 1 / (lambda^2)
# Calcular la desviación estándar (sigma)
sigma <- sqrt(varianza)
print(paste("Tasa lambda:", r(lambda)))
print(paste("Esperanza (mu):", r(esperanza)))
print(paste("Varianza (sigma^2):", r(varianza)))
print(paste("Desviación Estándar (sigma):", r(sigma)))
hist(DF$Promedio,
breaks = 30,
probability = TRUE,
main = "Gráfico del Promedio",
col = "lightblue")
# Línea de densidad empírica
lines(density(DF$Promedio, na.rm = TRUE), lwd = 3, col = "red")
# Línea de densidad teórica (distribución normal)
lines(seq(min(DF$Promedio, na.rm = TRUE), max(DF$Promedio, na.rm = TRUE), length.out = 100),
dnorm(seq(min(DF$Promedio, na.rm = TRUE), max(DF$Promedio, na.rm = TRUE), length.out = 100),
mean = mean(DF$Promedio, na.rm = TRUE),
sd = sd(DF$Promedio, na.rm = TRUE)),
lwd = 2, col = "darkgreen")
moda <- calcular_moda(DF$Promedio)
print(paste("Moda:", r(moda)))
media <- mean(DF$Promedio)
print(paste("Media:", r(media)))
mediana <- median(DF$Promedio)
print(paste("Mediana:", r(mediana)))
mu <- media
sigma <- sd(DF$Promedio, na.rm = TRUE)
print(paste("Sigma:", r(sigma)))
f <- function(x) {
(1 / (sigma * sqrt(2 * pi))) * exp(-((x - mu)^2) / (2 * sigma^2))
}
esperanza <- integrate(function(x) x * f(x), 0, 20)$value
cat("Valor esperado E(X) =", r(esperanza), "\n")
# Calcular la integral para obtener E(X^2) en el rango [0, 20]
expected_square <- integrate(function(x) x^2 * f(x), 0, 20)$value
# Calcular la varianza Var(X)
variance <- expected_square - esperanza^2
cat("Varianza Var(X) =", r(variance), "\n")
# Crear la tabla de contingencia para el gráfico de mosaico
tabla_contingencia <- matrix(c(
n_g1 - n_g1_ec,  # Estudiantes que gastan <50 y no van a Starbucks/Cafetería
n_g1_ec,         # Estudiantes que gastan <50 y van a Starbucks/Cafetería
n_g2 - n_g2_ec,  # Estudiantes que gastan 50-100 y no van a Starbucks/Cafetería
n_g2_ec          # Estudiantes que gastan 50-100 y van a Starbucks/Cafetería
), nrow = 2, byrow = TRUE)
colnames(tabla_contingencia) <- c("Otro", "Starbucks/Cafetería")
rownames(tabla_contingencia) <- c("<50", "50-100")
# Colores tenues para los mosaicos
colores <- c("lightblue", "lightpink")
# Crear el gráfico de mosaico con colores y frecuencias
mosaicplot(tabla_contingencia,
main = "Gráfico de Mosaico de Probabilidades Condicionales",
xlab = "Establecimiento",
ylab = "Gasto",
color = colores,
border = "gray")
de2 <- prop.table(table(DF$Frecuencia_reunion))
barp <- barplot(
de2,
main = "Probabilidades de frecuencias de reunión para tomar café",
col = "lightgray",
xlab = "Frecuencias de reunión",
ylab = "Probabilidad",
ylim = c(0, max(de2) + 0.05),
cex.names = 0.6
)
text(
x = barp,
y = de2 + 0.01,
labels = round(de2,2),
cex = 0.8,
col = "black",
pos = 3
)
#Cantidad de exitos acumulados deseados (la mitad de la muestra a seleccionar)
x=5
#Cantidad de alumnos seleccionados (ensayos o replicas realizadas)
n=10
#Probabilidad empirica del exito
p=sum(DF$Frecuencia_reunion %in% c("Siempre","Algunas veces"))/nrow(DF)
#Calculo de la probabilidad
pe2 <- pbinom(x,n,p,lower.tail = FALSE)
paste("P(X):",r(pe2))
i<-1
correlacion_total <- cor(DF$Tazas_por_dia, DF$Promedio, use = "complete.obs")
print(paste0("Coeficiente de correlación entre Tazas por día y Promedio académico:", correlacion_total))
DF_naomit <- na.omit(DF)
# Establecer la ecuación de regresión lineal
modelo <- lm(DF_naomit$Promedio~DF_naomit$Tazas_por_dia)
intercepto <- coef(modelo)[1]
pendiente <- coef(modelo)[2]
paste0("La ecuación de regresión para un modelo lineal es: y = ",pendiente,"x + ",intercepto)
# Crear el gráfico
ggplot(DF_naomit, aes(x = Tazas_por_dia, y = Promedio)) +
geom_point(color = "blue") +  # Puntos del gráfico
geom_smooth(method = "lm", se = FALSE, color = "peru") +
labs(x = "Tazas de café por día",
y = "Promedio Académico",
title = paste0("Gráfico 3.", i),
subtitle = "Relación entre consumo de tazas de café por día y promedio académico") +  # Agregar subtítulo aquí
theme_minimal()
i <- i + 1
i<-1
correlacion_total <- cor(DF$Tazas_por_dia, DF$Promedio, use = "complete.obs")
print(paste0("Coeficiente de correlación entre Tazas por día y Promedio académico:", correlacion_total))
DF_naomit <- na.omit(DF)
# Establecer la ecuación de regresión lineal
modelo <- lm(DF_naomit$Promedio~DF_naomit$Tazas_por_dia)
intercepto <- coef(modelo)[1]
pendiente <- coef(modelo)[2]
paste0("La ecuación de regresión para un modelo lineal es: y = ",pendiente,"x + ",intercepto)
# Crear el gráfico
ggplot(DF_naomit, aes(x = Tazas_por_dia, y = Promedio)) +
geom_point(color = "blue") +  # Puntos del gráfico
geom_smooth(method = "lm", se = FALSE, color = "peru") +
labs(x = "Tazas de café por día",
y = "Promedio Académico",
title = paste0("Gráfico 3.", i),
subtitle = "Relación entre consumo de tazas de café por día y promedio académico") +  # Agregar subtítulo aquí
theme_minimal()
i <- i + 1
i<-1
correlacion_total <- cor(DF$Tazas_por_dia, DF$Promedio, use = "complete.obs")
print(paste0("Coeficiente de correlación entre Tazas por día y Promedio académico:", correlacion_total))
DF_naomit <- na.omit(DF)
# Crear el gráfico
ggplot(DF_naomit, aes(x = Tazas_por_dia, y = Promedio)) +
geom_point(color = "blue") +  # Puntos del gráfico
geom_smooth(method = "lm", se = FALSE, color = "peru") +
labs(x = "Tazas de café por día",
y = "Promedio Académico",
title = paste0("Gráfico 3.", i),
subtitle = "Relación entre consumo de tazas de café por día y promedio académico") +  # Agregar subtítulo aquí
theme_minimal()
i <- i + 1
i<-1
correlacion_total <- cor(DF$Tazas_por_dia, DF$Promedio, use = "complete.obs")
print(paste0("Coeficiente de correlación entre Tazas por día y Promedio académico:", correlacion_total))
DF_naomit <- na.omit(DF)
# Establecer la ecuación de regresión lineal
modelo <- lm(DF_naomit$Promedio~DF_naomit$Tazas_por_dia)
intercepto <- coef(modelo)[1]
pendiente <- coef(modelo)[2]
paste0("La ecuación de regresión para un modelo lineal es: y = ",pendiente,"x + ",intercepto)
# Crear el gráfico
ggplot(DF_naomit, aes(x = Tazas_por_dia, y = Promedio)) +
geom_point(color = "blue") +  # Puntos del gráfico
geom_smooth(method = "lm", se = FALSE, color = "peru") +
labs(x = "Tazas de café por día",
y = "Promedio Académico",
title = paste0("Gráfico 3.", i),
subtitle = "Relación entre consumo de tazas de café por día y promedio académico") +  # Agregar subtítulo aquí
theme_minimal()
i <- i + 1
tabla_mosaico
help_mosaic <- prop.table(tabla_mosaico)
help_mosaic
# Crear la tabla de datos
datos <- DF %>%
select(Frecuencia_reunion, Frecuencia_cafeterias_semana, Establecimiento_compra) %>%
mutate(
Frecuencia_reunion = factor(Frecuencia_reunion,
levels = c("Nunca", "Rara vez", "Algunas veces", "Siempre"),
ordered = TRUE),
Frecuencia_cafeterias_semana = factor(Frecuencia_cafeterias_semana,
levels = c("0", "1", "2", "3", "4 a más"),
ordered = TRUE),
Establecimiento_compra = factor(Establecimiento_compra)
)
library(tidyverse)
# Crear la tabla de datos
datos <- DF %>%
select(Frecuencia_reunion, Frecuencia_cafeterias_semana, Establecimiento_compra) %>%
mutate(
Frecuencia_reunion = factor(Frecuencia_reunion,
levels = c("Nunca", "Rara vez", "Algunas veces", "Siempre"),
ordered = TRUE),
Frecuencia_cafeterias_semana = factor(Frecuencia_cafeterias_semana,
levels = c("0", "1", "2", "3", "4 a más"),
ordered = TRUE),
Establecimiento_compra = factor(Establecimiento_compra)
)
# Crear la tabla de mosaico
tabla_mosaico <- table(datos$Frecuencia_reunion, datos$Establecimiento_compra)
# Calcular las probabilidades usando prop.table()
probabilidades <- prop.table(tabla_mosaico)
# Mostrar las probabilidades
print(probabilidades)
# Crear el gráfico de mosaico
mosaicplot(tabla_mosaico,
xlab = "Frecuencia de Reuniones",
ylab = "",  # Mantener en blanco para eliminar etiquetas de eje Y
col = adjustcolor(rainbow(ncol(tabla_mosaico)), alpha.f = 0.7),
border = "white",
las = 1,
cex.axis = 0.5)
title(sub="Relación de la frecuencia de las reuniones por establecimiento de compra")
library(tidyverse)
# Crear la tabla de datos
# Crear la tabla de datos
datos <- DF %>%
select(Frecuencia_reunion, Frecuencia_cafeterias_semana, Establecimiento_compra) %>%
mutate(
Frecuencia_reunion = factor(Frecuencia_reunion,
levels = c("Nunca", "Rara vez", "Algunas veces", "Siempre"),
ordered = TRUE),
Frecuencia_cafeterias_semana = factor(Frecuencia_cafeterias_semana,
levels = c("0", "1", "2", "3", "4 a más"),
ordered = TRUE),
Establecimiento_compra = factor(Establecimiento_compra)
)
# Crear la tabla de mosaico
tabla_mosaico <- table(datos$Frecuencia_reunion, datos$Establecimiento_compra)
# Calcular las proporciones usando prop.table()
probabilidades <- prop.table(tabla_mosaico)
# Convertir a porcentajes y redondear al segundo decimal
porcentajes <- round(probabilidades * 100, 2)
# Mostrar los porcentajes
print(porcentajes)
barplot(prop.table(table(DF$Frecuencia_reunion)))
barplot(prop.table(table(DF$Establecimiento_compra)))
# Gráfico de barras para Frecuencia de Reunión
frecuencia_reunion <- prop.table(table(DF$Frecuencia_reunion))
barplot_frecuencia_reunion <- barplot(
frecuencia_reunion,
main = "Frecuencia de Reunión",
xlab = "Categoría",
ylab = "Probabilidad",
col = "lightblue",
ylim = c(0, max(frecuencia_reunion) + 0.05)
)
# Añadir etiquetas de probabilidades
text(
x = barplot_frecuencia_reunion,
y = frecuencia_reunion,
labels = paste0(round(frecuencia_reunion * 100, 2), "%"),
pos = 3, # Posicionamiento encima de las barras
cex = 1,
col = "black"
)
# Gráfico de barras para Establecimiento de Compra
establecimiento_compra <- prop.table(table(DF$Establecimiento_compra))
barplot_establecimiento_compra <- barplot(
establecimiento_compra,
main = "Establecimiento de Compra",
xlab = "Categoría",
ylab = "Probabilidad",
col = "lightgreen",
ylim = c(0, max(establecimiento_compra) + 0.05)
)
# Añadir etiquetas de probabilidades
text(
x = barplot_establecimiento_compra,
y = establecimiento_compra,
labels = paste0(round(establecimiento_compra * 100, 2), "%"),
pos = 3, # Posicionamiento encima de las barras
cex = 1,
col = "black"
)
# Gráfico de barras para Frecuencia de Reunión
frecuencia_reunion <- prop.table(table(DF$Frecuencia_reunion))
barplot_frecuencia_reunion <- barplot(
frecuencia_reunion,
main = "Frecuencia de Reunión",
xlab = "Categoría",
ylab = "Probabilidad",
col = "lightblue",
ylim = c(0, max(frecuencia_reunion) + 0.05)
)
# Añadir etiquetas de probabilidades
text(
x = barplot_frecuencia_reunion,
y = frecuencia_reunion,
labels = paste0(round(frecuencia_reunion * 100, 2), "%"),
pos = 3, # Posicionamiento encima de las barras
cex = 1,
col = "black"
)
# Gráfico de barras para Establecimiento de Compra
establecimiento_compra <- prop.table(table(DF$Establecimiento_compra))
barplot_establecimiento_compra <- barplot(
establecimiento_compra,
main = "Establecimiento de Compra",
xlab = "Categoría",
ylab = "Probabilidad",
col = "lightgreen",
ylim = c(0, max(establecimiento_compra) + 0.05)
)
# Añadir etiquetas de probabilidades
text(
x = barplot_establecimiento_compra,
y = establecimiento_compra,
labels = paste0(round(establecimiento_compra * 100, 2), "%"),
pos = 3, # Posicionamiento encima de las barras
cex = 0.5,
col = "black"
)
# Gráfico de barras para Frecuencia de Reunión
frecuencia_reunion <- prop.table(table(DF$Frecuencia_reunion))
barplot_frecuencia_reunion <- barplot(
frecuencia_reunion,
main = "Frecuencia de Reunión",
xlab = "Categoría",
ylab = "Probabilidad",
col = "lightblue",
ylim = c(0, max(frecuencia_reunion) + 0.05)
)
# Añadir etiquetas de probabilidades
text(
x = barplot_frecuencia_reunion,
y = frecuencia_reunion,
labels = paste0(round(frecuencia_reunion * 100, 2), "%"),
pos = 3, # Posicionamiento encima de las barras
cex = 1,
col = "black"
)
# Gráfico de barras para Establecimiento de Compra
establecimiento_compra <- prop.table(table(DF$Establecimiento_compra))
barplot_establecimiento_compra <- barplot(
establecimiento_compra,
main = "Establecimiento de Compra",
xlab = "Categoría",
ylab = "Probabilidad",
col = "lightgreen",
ylim = c(0, max(establecimiento_compra) + 0.05)
)
# Añadir etiquetas de probabilidades
text(
x = barplot_establecimiento_compra,
y = establecimiento_compra,
labels = paste0(round(establecimiento_compra * 100, 2), "%"),
pos = 3, # Posicionamiento encima de las barras
cex = 1,
col = "black"
)
# Gráfico de barras para Frecuencia de Reunión
frecuencia_reunion <- prop.table(table(DF$Frecuencia_reunion))
barplot_frecuencia_reunion <- barplot(
frecuencia_reunion,
main = "Frecuencia de Reunión",
xlab = "Categoría",
ylab = "Probabilidad",
col = "lightblue",
ylim = c(0, max(frecuencia_reunion) + 0.05)
)
# Añadir etiquetas de probabilidades
text(
x = barplot_frecuencia_reunion,
y = frecuencia_reunion,
labels = paste0(round(frecuencia_reunion * 100, 2), "%"),
pos = 3, # Posicionamiento encima de las barras
cex = 1,
col = "black"
)
# Gráfico de barras para Establecimiento de Compra
establecimiento_compra <- prop.table(table(DF$Establecimiento_compra))
barplot_establecimiento_compra <- barplot(
establecimiento_compra,
main = "Establecimiento de Compra",
xlab = "Categoría",
ylab = "Probabilidad",
col = "lightgreen",
ylim = c(0, max(establecimiento_compra) + 0.05)
)
# Añadir etiquetas de probabilidades
text(
x = barplot_establecimiento_compra,
y = establecimiento_compra,
labels = paste0(round(establecimiento_compra * 100, 2), "%"),
pos = 3, # Posicionamiento encima de las barras
cex = 1,
col = "black"
)
# Gráfico de barras para Frecuencia de Reunión
frecuencia_reunion <- prop.table(table(DF$Frecuencia_reunion))
barplot_frecuencia_reunion <- barplot(
frecuencia_reunion,
main = "Frecuencia de Reunión",
xlab = "Categoría",
ylab = "Probabilidad",
col = "lightblue",
ylim = c(0, max(frecuencia_reunion) + 0.05)
)
# Añadir etiquetas de probabilidades
text(
x = barplot_frecuencia_reunion,
y = frecuencia_reunion,
labels = paste0(round(frecuencia_reunion * 100, 2), "%"),
pos = 3, # Posicionamiento encima de las barras
cex = 1,
col = "black"
)
# Gráfico de barras para Establecimiento de Compra
establecimiento_compra <- prop.table(table(DF$Establecimiento_compra))
barplot_establecimiento_compra <- barplot(
establecimiento_compra,
main = "Establecimiento de Compra",
xlab = "Categoría",
ylab = "Probabilidad",
col = "lightgreen",
ylim = c(0, max(establecimiento_compra) + 0.05)
)
# Añadir etiquetas de probabilidades
text(
x = barplot_establecimiento_compra,
y = establecimiento_compra,
labels = paste0(round(establecimiento_compra * 100, 2), "%"),
pos = 3, # Posicionamiento encima de las barras
cex = 1,
col = "black"
)
# Gráfico de barras para Frecuencia de Reunión
frecuencia_reunion <- prop.table(table(DF$Frecuencia_reunion))
barplot_frecuencia_reunion <- barplot(
frecuencia_reunion,
main = "Frecuencia de Reunión",
xlab = "Categoría",
ylab = "Probabilidad",
col = "lightblue",
ylim = c(0, max(frecuencia_reunion) + 0.05)
)
# Añadir etiquetas de probabilidades
text(
x = barplot_frecuencia_reunion,
y = frecuencia_reunion,
labels = paste0(round(frecuencia_reunion * 100, 2), "%"),
pos = 3, # Posicionamiento encima de las barras
cex = 1,
col = "black"
)
# Gráfico de barras para Establecimiento de Compra con ajuste del tamaño de etiquetas
barplot_establecimiento_compra <- barplot(
establecimiento_compra,
main = "Establecimiento de Compra",
xlab = "Categoría",
ylab = "Probabilidad",
col = "lightgreen",
ylim = c(0, max(establecimiento_compra) + 0.05),
cex.names = 0.7  # Ajusta el valor según lo necesites
)
# Añadir etiquetas de probabilidades
text(
x = barplot_establecimiento_compra,
y = establecimiento_compra,
labels = paste0(round(establecimiento_compra * 100, 2), "%"),
pos = 3, # Posicionamiento encima de las barras
cex = 1,
col = "black"
)
# Gráfico de barras para Frecuencia de Reunión
frecuencia_reunion <- prop.table(table(DF$Frecuencia_reunion))
barplot_frecuencia_reunion <- barplot(
frecuencia_reunion,
main = "Frecuencia de Reunión",
xlab = "Categoría",
ylab = "Probabilidad",
col = "lightblue",
ylim = c(0, max(frecuencia_reunion) + 0.05)
)
# Añadir etiquetas de probabilidades
text(
x = barplot_frecuencia_reunion,
y = frecuencia_reunion,
labels = paste0(round(frecuencia_reunion * 100, 2), "%"),
pos = 3, # Posicionamiento encima de las barras
cex = 1,
col = "black"
)
# Gráfico de barras para Establecimiento de Compra con ajuste del tamaño de etiquetas
barplot_establecimiento_compra <- barplot(
establecimiento_compra,
main = "Establecimiento de Compra",
xlab = "Categoría",
ylab = "Probabilidad",
col = "lightgreen",
ylim = c(0, max(establecimiento_compra) + 0.05),
cex.names = 0.5  # Ajusta el valor según lo necesites
)
# Añadir etiquetas de probabilidades
text(
x = barplot_establecimiento_compra,
y = establecimiento_compra,
labels = paste0(round(establecimiento_compra * 100, 2), "%"),
pos = 3, # Posicionamiento encima de las barras
cex = 1,
col = "black"
)
